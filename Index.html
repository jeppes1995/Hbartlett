<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>my writings - a digital journal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        /* Custom Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* A soft, neutral background */
            color: #333;
            text-transform: lowercase; /* Make all text lowercase */
        }

        .font-playfair {
            font-family: 'Playfair Display', serif;
        }

        /* Custom sharp shadow for notes */
        .note-shadow {
            box-shadow: 6px 6px 0px #1a202c;
        }
      
        /* Smooth transitions for hover effects and expansion/collapse */
        .note {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out, max-height 0.5s ease-in-out;
            cursor: pointer;
            overflow: hidden; /* Important for max-height transition */
            max-height: 180px; /* Adjusted initial max height for shorter snippet */
        }

        .note.is-expanded {
            max-height: 1200px; /* Large enough to fit expanded content, adjust if very long content */
        }

        /* Combined hover effect: grow and change shadow */
        .note:hover:not(.is-expanded) { 
            transform: scale(1.03); /* Grow effect */
            box-shadow: 8px 8px 0px #2d3748; /* Darker/larger shadow on hover */
        }
        
        .note-snippet {
            padding-bottom: 1.25rem; 
        }

        /* Styling for text containers within notes to handle word wrapping */
        .note-snippet p, 
        .note-content-full div { /* Targets the div directly inside .note-content-full */
            overflow-wrap: break-word; /* Standard property */
            word-wrap: break-word;     /* Older browsers, alias for overflow-wrap */
        }

        .note-content-full {
            display: none; 
            padding-top: 1rem; 
            opacity: 0; /* Start hidden for transition */
            transition: opacity 0.3s ease-in-out 0.2s; /* Fade in after height transition starts */
        }

        .note.is-expanded .note-content-full {
            display: block;
            opacity: 1;
        }
        
        /* Custom scrollbar (optional) */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f0f2f5;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }

        /* Simple fade-in animation for elements */
        .fade-in {
            animation: fadeInAnimation 0.8s ease-in-out forwards;
            opacity: 0;
        }

        @keyframes fadeInAnimation {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Staggered fade-in for notes - initial state for JS */
        .writings-grid .note, #featured-note { 
            opacity: 0; 
        }

    </style>
</head>
<body class="antialiased">

    <section class="py-16 md:py-24 bg-gradient-to-br from-slate-50 to-stone-100 fade-in" style="animation-delay: 0.2s;">
        <div class="container mx-auto px-6 text-center">
            <h1 class="font-playfair text-4xl md:text-6xl font-bold text-gray-800 mb-4">mine ord</h1>
            <p class="text-lg md:text-xl text-gray-600 mb-10 max-w-2xl mx-auto">
                mine tanker, ord og reflektioner. det var tid til at det snart skulle ud
            </p>
            <div id="featured-note" class="note max-w-xl mx-auto bg-white p-8 rounded-2xl note-shadow transform transition-all duration-300 ease-in-out">
                <div class="note-snippet">
                    <h3 class="font-playfair text-3xl font-semibold text-gray-800 mb-3" id="featured-title">loading featured note...</h3>
                    <p class="text-gray-600 leading-relaxed text-sm" id="featured-snippet-text">
                        please wait...
                    </p>
                </div>
                <div class="note-content-full text-left" id="featured-content-full">
                    <p class="text-gray-700 leading-loose mt-4">
                        full content will appear here.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <main id="writings" class="py-16 md:py-20 container mx-auto px-6">
        <h2 class="font-playfair text-4xl md:text-5xl font-bold text-gray-800 text-center mb-16 fade-in" style="animation-delay: 0.4s;">
            mine skriv
        </h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10 md:gap-12 writings-grid">
            </div>
    </main>

    <footer class="bg-gray-800 text-gray-300 py-12 fade-in" style="animation-delay: 0.6s;">
        <div class="container mx-auto px-6 text-center">
            <p class="font-playfair text-xl mb-2">&copy; <span id="currentYear"></span> jeppe hedegaard bartlett</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Data for Writings ---
            const writingsData = [
                {
                    title: "ok",
                    fullText: "Jeg ser dig hver dag En jakke, en cykelist, en stemme i det fjerne.  Mange ting minder om dig Er det afsavnet?  Er det mit min samvittighed?  Er det dig?   Savn fortolkes  Savn overvejes Tårer spildes  Tårer grædes  To sønner uden deres far En far som altid har været der En far som har lyttet En far som har forstået  En far som har støttet   Du er her ikke mere  3 år er gået på få øjeblikke  Hvis 3 år kan forsvinde ved et knips Hvad så med mit liv?  Hvad med mine døtre?  Når jeg at opdage, lære dem at kende,  opdrage dem, elske dem?  Jeg ser dig hver dag,  så hvorfor savner jeg dig så meget?  Hvordan kan jeg være fortabt, når jeg ikke ved hvor jeg skal hen?"
                },
                {
                    title: "ok2",
                    fullText: "Hvad sker der når vi dør? Bliver vi mødt? Bliver vi mødt af vores indre afsavn? Dem som vi ikke følte vi besøgte nok Dem som vi ikke elskede nok Dem som vi ikke kunne leve uden Dem som vi nu kan være sammen med   Men bliver vi accepteret?  Har de affundet sig ved døden?  Kan de leve med at du er ankommet?  Eller bliver der sort?  Sort. Ingenting. Nul.  Måske vi bliver mødt af det vi tror på En gud, en filosofi, en tanke? Et familiemedlem. Lever vi videre i de levendes tanker?  Eller bliver vi glemt?   En ting er sikkert.  Taler vi aldrig om de døde, så bliver der sort.  Så kan vi ikke leve videre  så bliver vi glemt, og når man bliver glemt, er man ikke længere til.    Sort. Ingenting. Nul"
                },
                {
                    title: "ok3",
                    fullText: "Livet er og bliver svært  Det er svært at være til Det er svært at kigge sig omkring  Det er svært at kigge ind ad.  Fordi, kigger vi kun ud,  får vi så nogensinde styr, styr på os selv og vores egne problemer  styr på os selv og vores egne mangler? vores egne fejl?   Men hvorfor er livet så svært?  Livet er som et korthus, det kan blives stort og smukt, men med et enkelt forkert pust, bum. Så er livet veltet, endt og gået.  og nåede du alt det du skulle mens du var her?  nåede du at elske? nåede du at blive elsket?  nåede du at finde ud af hvad du skulle mens du var her?  Nåede du at finde ud af hvorfor du var her?   Livet er svært  Der er mange spørgsmål der puster på ens korthus.  Hver eneste dag med frygt for at det vil falde. Og hvis det falder, er det så for sent at bygge det op på ny?  Meningen med det hele er nok at mestre,  mestre ikke at spekulere  Ikke at spekulere om du var god nok om andre synes du var god nok, eller om dine egne forventninger blev opfyldt   Livet er svært,  men kan du tæmme spekulationens fangarme, kan det måske blive en smule lettere at være til,  i denne verden "
                }
            ];

            // --- Helper Function to Create Snippet (Improved Logic) ---
            function createSnippet(fullText, wordCount = 10, charLimit = 75) {
                // 1. Get plain text
                const textOnly = fullText.replace(/<[^>]+>/g, ' ').replace(/\s+/g, ' ').trim();
                if (!textOnly) {
                    return ''; // Handle empty or whitespace-only input
                }

                const words = textOnly.split(' ');
                let needsEllipsis = false;

                // 2. Take the first 'wordCount' words
                let snippetWordsArray = words.slice(0, wordCount);
                let currentSnippet = snippetWordsArray.join(' ');

                // 3. Check if original text had more words than taken for the snippet
                if (words.length > wordCount) {
                    needsEllipsis = true;
                }

                // 4. Apply character limit to the current snippet if it's too long
                if (currentSnippet.length > charLimit) {
                    currentSnippet = currentSnippet.substring(0, charLimit);
                    needsEllipsis = true; // Character truncation also implies ellipsis

                    // Try to break at the last space to avoid cutting a word mid-way,
                    // but only if we actually truncated (currentSnippet.length is now charLimit)
                    const lastSpaceIndex = currentSnippet.lastIndexOf(' ');
                    if (lastSpaceIndex > 0 && currentSnippet.length === charLimit) { 
                        currentSnippet = currentSnippet.substring(0, lastSpaceIndex);
                    }
                }
                
                // 5. Append ellipsis if needed
                if (needsEllipsis) {
                    // Prevent double ellipsis if substring somehow ended with one (unlikely with this logic)
                    if (currentSnippet.endsWith('...')) { 
                        return currentSnippet;
                    }
                    // Clean up potential trailing punctuation before adding ellipsis
                    if (currentSnippet.endsWith('.') || currentSnippet.endsWith(',')) {
                        currentSnippet = currentSnippet.slice(0, -1);
                    }
                    return currentSnippet.trim() + '...'; // Ensure no trailing space before ellipsis
                }

                return currentSnippet; // Return as is if no truncation by word or char happened
            }

            // --- Function to Create a Grid Note Element ---
            function createGridNoteElement(noteData) {
                const article = document.createElement('article');
                article.className = 'note bg-white p-6 md:p-8 rounded-2xl note-shadow transform';

                const snippetDiv = document.createElement('div');
                snippetDiv.className = 'note-snippet';

                const titleH3 = document.createElement('h3');
                titleH3.className = 'font-playfair text-2xl font-semibold text-gray-800 mb-3';
                titleH3.textContent = noteData.title;

                const snippetP = document.createElement('p');
                snippetP.className = 'text-gray-600 leading-relaxed text-sm';
                snippetP.textContent = createSnippet(noteData.fullText);

                snippetDiv.appendChild(titleH3);
                snippetDiv.appendChild(snippetP);

                const fullContentDiv = document.createElement('div');
                fullContentDiv.className = 'note-content-full text-left';
                fullContentDiv.innerHTML = `<div class="text-gray-700 leading-loose mt-4">${noteData.fullText}</div>`;

                article.appendChild(snippetDiv);
                article.appendChild(fullContentDiv);

                return article;
            }
            
            // --- Populate Writings Grid ---
            const writingsGrid = document.querySelector('.writings-grid');
            if (writingsGrid) {
                writingsData.forEach(data => {
                    const noteEl = createGridNoteElement(data);
                    writingsGrid.appendChild(noteEl);
                });
            }

            // --- Random Featured Note Logic ---
            const featuredNoteElement = document.getElementById('featured-note');
            const featuredTitleElement = document.getElementById('featured-title');
            const featuredSnippetElement = document.getElementById('featured-snippet-text');
            const featuredContentFullElement = document.getElementById('featured-content-full');
            
            if (writingsData.length > 0 && featuredNoteElement) {
                const randomIndex = Math.floor(Math.random() * writingsData.length);
                const randomNoteData = writingsData[randomIndex];

                featuredTitleElement.textContent = randomNoteData.title;
                featuredSnippetElement.textContent = createSnippet(randomNoteData.fullText);
                featuredContentFullElement.innerHTML = `<div class="text-gray-700 leading-loose mt-4">${randomNoteData.fullText}</div>`;
            } else if (featuredNoteElement) {
                featuredTitleElement.textContent = "no writings yet";
                featuredSnippetElement.textContent = "add some notes to the collection to see one featured here.";
                featuredContentFullElement.innerHTML = "<p>your amazing content will appear here once you add notes.</p>";
            }

            // --- Apply Event Listeners and Animations to ALL notes ---
            const allNoteDOMElements = document.querySelectorAll('.note'); 

            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1 
            };
            const scrollObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach((entry) => { 
                    if (entry.isIntersecting) {
                        const actualIndex = Array.from(allNoteDOMElements).indexOf(entry.target);
                        entry.target.style.animation = `fadeInAnimation 0.5s ease-in-out ${actualIndex * 0.1}s forwards`;
                        observer.unobserve(entry.target);
                    }
                });
            }, observerOptions);

            allNoteDOMElements.forEach(note => {
                scrollObserver.observe(note);

                note.addEventListener('click', (event) => {
                    if (event.target.tagName === 'A' && note.classList.contains('is-expanded')) {
                        return; 
                    }
                    if (event.offsetX > note.clientWidth - 16 && note.scrollHeight > note.clientHeight) { 
                         return; 
                    }

                    const wasExpanded = note.classList.contains('is-expanded');

                    allNoteDOMElements.forEach(otherNote => {
                        if (otherNote !== note && otherNote.classList.contains('is-expanded')) {
                            otherNote.classList.remove('is-expanded');
                        }
                    });
                    note.classList.toggle('is-expanded');
                    
                    if (note.classList.contains('is-expanded') && !wasExpanded) {
                        const noteRect = note.getBoundingClientRect();
                        const isTopOffScreen = noteRect.top < 0;
                        const isBottomWayDown = noteRect.top > window.innerHeight * 0.6; 

                        if (isTopOffScreen || isBottomWayDown ) { 
                            setTimeout(() => {
                                note.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' });
                            }, 100); 
                        }
                    }
                });
            });

            const currentYearElement = document.getElementById('currentYear');
            if (currentYearElement) {
                currentYearElement.textContent = new Date().getFullYear();
            }
        });
    </script>

</body>
</html>